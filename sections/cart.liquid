{%- liquid
  assign cart_title = section.settings.title | default: 'YOUR CART'
  assign empty_cart_title = section.settings.empty_title | default: 'Your cart is empty'
  assign empty_cart_text = section.settings.empty_text | default: 'Continue shopping to add items to your cart.'
  assign continue_shopping_text = section.settings.continue_shopping_text | default: 'continue shopping'
  assign continue_shopping_url = section.settings.continue_shopping_url | default: routes.all_products_collection_url
  assign buy_now_text = section.settings.buy_now_text | default: 'Buy Now'
  assign promo_code_label = section.settings.promo_code_label | default: 'PROMO CODE'
  assign promo_code_placeholder = section.settings.promo_code_placeholder | default: 'ENTER HERE'
  
  # Calculate total item-level discounts
  assign total_item_discounts = 0
  for item in cart.items
    if item.discount_allocated_amount > 0
      assign total_item_discounts = total_item_discounts | plus: item.discount_allocated_amount
    endif
  endfor
-%}

<section class="cart-page" id="cart-page-{{ section.id }}">
  <div class="cart-page__container">
    <h1 class="cart-page__title">{{ cart_title }}</h1>

    {%- if cart.item_count > 0 -%}
      <div class="cart-page__progress">
        <div class="cart-page__progress-bar">
          <span class="cart-page__progress-text">{{ cart.item_count }} ITEMS SELECTED</span>
        </div>
      </div>

      <form action="{{ routes.cart_url }}" method="post" id="cart-form" class="cart-page__form">
        <div class="cart-page__content">
          <div class="cart-page__products">
            <div class="cart-products__header">
              <div class="cart-products__header-cell cart-products__header-cell--product">PRODUCT DETAILS</div>
              <div class="cart-products__header-cell cart-products__header-cell--price">PRICE</div>
              <div class="cart-products__header-cell cart-products__header-cell--qty">QTY</div>
              <div class="cart-products__header-cell cart-products__header-cell--total">TOTAL</div>
            </div>

            <div class="cart-products__items">
              {%- for item in cart.items -%}
                <div class="cart-product" data-line-item="{{ item.key }}">
                  <div class="cart-product__details">
                    <div class="cart-product__image">
                      {%- if item.image != blank -%}
                        <img 
                          src="{{ item.image | image_url: width: 150 }}" 
                          alt="{{ item.image.alt | default: item.title }}"
                          width="150"
                          height="150"
                          loading="lazy"
                        >
                      {%- else -%}
                        <div class="cart-product__placeholder">
                          {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
                        </div>
                      {%- endif -%}
                    </div>
                    <div class="cart-product__info">
                      <h3 class="cart-product__name">
                        <a href="{{ item.url }}">{{ item.product.title }}</a>
                      </h3>
                      {%- unless item.product.has_only_default_variant -%}
                        <p class="cart-product__description">{{ item.variant.title }}</p>
                      {%- else -%}
                        <p class="cart-product__description">product description</p>
                      {%- endunless -%}
                    </div>
                  </div>

                  <div class="cart-product__price">
                    {{ item.final_price | money }}
                  </div>

                  <div class="cart-product__quantity">
                    <button 
                      type="button" 
                      class="cart-product__quantity-btn" 
                      data-decrease-quantity
                      data-key="{{ item.key }}"
                      aria-label="Decrease quantity"
                    >
                      <span>-</span>
                    </button>
                    <input 
                      type="number" 
                      name="updates[]" 
                      value="{{ item.quantity }}" 
                      min="0" 
                      class="cart-product__quantity-input"
                      data-key="{{ item.key }}"
                    >
                    <button 
                      type="button" 
                      class="cart-product__quantity-btn" 
                      data-increase-quantity
                      data-key="{{ item.key }}"
                      aria-label="Increase quantity"
                    >
                      <span>+</span>
                    </button>
                  </div>

                  <div class="cart-product__total">
                    {{ item.final_line_price | money }}
                  </div>

                  <button 
                    type="button" 
                    class="cart-product__remove" 
                    data-remove-item
                    data-key="{{ item.key }}"
                    aria-label="Remove {{ item.product.title }}"
                  >
                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M4 4L12 12M12 4L4 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                  </button>
                </div>
              {%- endfor -%}
            </div>
          </div>

          <div class="cart-page__summary">
            <div class="cart-summary">
              <h2 class="cart-summary__title">ORDER SUMMARY</h2>
              
              <div class="cart-summary__row">
                <span class="cart-summary__label">SUBTOTAL</span>
                <span class="cart-summary__value" data-cart-subtotal>{{ cart.items_subtotal_price | money }}</span>
              </div>

              <div class="cart-summary__row">
                <span class="cart-summary__label">TAXES</span>
                <span class="cart-summary__value" data-cart-taxes>
                  {%- assign tax_amount = cart.total_price | minus: cart.items_subtotal_price -%}
                  {%- if tax_amount > 0 -%}
                    {{ tax_amount | money }}
                  {%- else -%}
                    {{ 0 | money }}
                  {%- endif -%}
                </span>
              </div>

              {%- if total_item_discounts > 0 -%}
                <div class="cart-summary__row cart-summary__row--discount">
                  <span class="cart-summary__label">Item Discounts</span>
                  <span class="cart-summary__value" data-cart-item-discounts>-{{ total_item_discounts | money }}</span>
                </div>
              {%- endif -%}

              {%- if cart.cart_level_discount_applications.size > 0 -%}
                {%- for discount in cart.cart_level_discount_applications -%}
                  <div class="cart-summary__row cart-summary__row--discount" data-cart-discount-row>
                    <span class="cart-summary__label">
                      Discount ({{ discount.title }})
                    </span>
                    <span class="cart-summary__value" data-cart-discount-amount>-{{ discount.total_allocated_amount | money }}</span>
                  </div>
                {%- endfor -%}
              {%- endif -%}

              <div class="cart-summary__divider"></div>

              <div class="cart-summary__promo">
                <label for="promo-code-{{ section.id }}" class="cart-summary__promo-label">{{ promo_code_label }}</label>
                <input 
                  type="text" 
                  id="promo-code-{{ section.id }}"
                  class="cart-summary__promo-input" 
                  placeholder="{{ promo_code_placeholder }}"
                  data-promo-code
                >
              </div>

              <div class="cart-summary__row cart-summary__row--total">
                <span class="cart-summary__label">TOTAL</span>
                <span class="cart-summary__value cart-summary__value--total" data-cart-total>{{ cart.total_price | money }}</span>
              </div>

              <div class="cart-summary__actions">
                <button type="submit" name="checkout" class="cart-summary__btn cart-summary__btn--primary">
                  {{ buy_now_text }} →
                </button>
                <a href="{{ continue_shopping_url }}" class="cart-summary__btn cart-summary__btn--secondary">
                  {{ continue_shopping_text }}
                </a>
              </div>

              {%- if additional_checkout_buttons -%}
                <div class="cart-summary__additional-checkout">
                  {{ content_for_additional_checkout_buttons }}
                </div>
              {%- endif -%}
            </div>
          </div>
        </div>
      </form>
    {%- else -%}
      <div class="cart-page__empty">
        <div class="cart-empty">
          <h2 class="cart-empty__title">{{ empty_cart_title }}</h2>
          <p class="cart-empty__text">{{ empty_cart_text }}</p>
          <a href="{{ continue_shopping_url }}" class="cart-summary__btn cart-summary__btn--primary">
            {{ continue_shopping_text }}
          </a>
        </div>
      </div>
    {%- endif -%}
  </div>
</section>

<script>
  (function() {
    const initCart = () => {
      const cartForm = document.getElementById('cart-form');
      if (!cartForm) {
        console.warn('Cart form not found');
        return;
      }

      const formatMoney = (cents) => {
        if (typeof cents !== 'number' || isNaN(cents)) {
          return '₹0.00';
        }
        const isNegative = cents < 0;
        const absCents = Math.abs(cents);
        const dollars = absCents / 100;
        const formatted = dollars.toFixed(2);
        return isNegative ? `-₹${formatted}` : `₹${formatted}`;
      };

      const updateCartSummary = (cart) => {
        if (!cart) {
          console.warn('Cart data is missing');
          return;
        }
        
        if (!cart.items || cart.items.length === 0) {
          location.reload();
          return;
        }

        let totalItemDiscounts = 0;
        for (const item of cart.items) {
          if (item.discount_allocated_amount && item.discount_allocated_amount > 0) {
            totalItemDiscounts += item.discount_allocated_amount;
          }
        }

        let cartDiscountTotal = 0;
        if (cart.cart_level_discount_applications) {
          for (const discount of cart.cart_level_discount_applications) {
            if (discount.total_allocated_amount) {
              cartDiscountTotal += discount.total_allocated_amount;
            }
          }
        }

        const subtotalEl = cartForm.querySelector('[data-cart-subtotal]');
        if (subtotalEl && cart.items_subtotal_price !== undefined) {
          subtotalEl.textContent = formatMoney(cart.items_subtotal_price);
        }

        const taxesEl = cartForm.querySelector('[data-cart-taxes]');
        if (taxesEl) {
          const taxAmount = cart.total_price - cart.items_subtotal_price;
          taxesEl.textContent = formatMoney(taxAmount > 0 ? taxAmount : 0);
        }

        const itemDiscountsEl = cartForm.querySelector('[data-cart-item-discounts]');
        const itemDiscountsRow = itemDiscountsEl?.closest('.cart-summary__row');
        if (totalItemDiscounts > 0) {
          if (!itemDiscountsRow) {
            const subtotalRow = cartForm.querySelector('[data-cart-subtotal]')?.closest('.cart-summary__row');
            if (subtotalRow) {
              const newRow = document.createElement('div');
              newRow.className = 'cart-summary__row cart-summary__row--discount';
              newRow.innerHTML = `
                <span class="cart-summary__label">Item Discounts</span>
                <span class="cart-summary__value" data-cart-item-discounts>-${formatMoney(totalItemDiscounts)}</span>
              `;
              subtotalRow.after(newRow);
            }
          } else if (itemDiscountsEl) {
            itemDiscountsEl.textContent = `-${formatMoney(totalItemDiscounts)}`;
          }
        } else if (itemDiscountsRow) {
          itemDiscountsRow.remove();
        }

        const existingDiscountRows = cartForm.querySelectorAll('[data-cart-discount-row]');
        existingDiscountRows.forEach(row => row.remove());

        if (cart.cart_level_discount_applications && cart.cart_level_discount_applications.length > 0) {
          const itemDiscountsRow = cartForm.querySelector('[data-cart-item-discounts]')?.closest('.cart-summary__row');
          const insertAfter = itemDiscountsRow || cartForm.querySelector('[data-cart-subtotal]')?.closest('.cart-summary__row');
          
          for (const discount of cart.cart_level_discount_applications) {
            if (discount.total_allocated_amount) {
              const newRow = document.createElement('div');
              newRow.className = 'cart-summary__row cart-summary__row--discount';
              newRow.setAttribute('data-cart-discount-row', '');
              newRow.innerHTML = `
                <span class="cart-summary__label">Discount (${discount.title || 'Discount'})</span>
                <span class="cart-summary__value" data-cart-discount-amount>-${formatMoney(discount.total_allocated_amount)}</span>
              `;
              if (insertAfter) {
                insertAfter.after(newRow);
              }
            }
          }
        }

        const totalEl = cartForm.querySelector('[data-cart-total]');
        if (totalEl && cart.total_price !== undefined) {
          totalEl.textContent = formatMoney(cart.total_price);
        }

        const progressText = document.querySelector('.cart-page__progress-text');
        if (progressText) {
          progressText.textContent = `${cart.item_count} ITEMS SELECTED`;
        }
      };

      const updateCartItems = (cart) => {
        if (!cart || !cart.items || cart.items.length === 0) {
          return;
        }

        for (const cartItem of cart.items) {
          const itemRow = cartForm.querySelector(`[data-line-item="${cartItem.key}"]`);
          if (!itemRow) continue;

          const quantityInput = itemRow.querySelector(`input[data-key="${cartItem.key}"]`);
          if (quantityInput) {
            quantityInput.value = cartItem.quantity;
          }

          const itemTotalEl = itemRow.querySelector('.cart-product__total');
          if (itemTotalEl && cartItem.final_line_price !== undefined) {
            itemTotalEl.textContent = formatMoney(cartItem.final_line_price);
          }

          const priceEl = itemRow.querySelector('.cart-product__price');
          if (priceEl && cartItem.final_price !== undefined) {
            priceEl.textContent = formatMoney(cartItem.final_price);
          }
        }

        const allItemRows = cartForm.querySelectorAll('[data-line-item]');
        const cartItemKeys = new Set(cart.items.map(item => item.key));
        for (const row of allItemRows) {
          const itemKey = row.getAttribute('data-line-item');
          if (!cartItemKeys.has(itemKey)) {
            row.remove();
          }
        }
      };

      const refreshCart = async () => {
        try {
          const response = await fetch('/cart.js');
          if (!response.ok) {
            throw new Error(`Failed to fetch cart: ${response.status} ${response.statusText}`);
          }
          const cart = await response.json();
          
          if (!cart || typeof cart !== 'object') {
            throw new Error('Invalid cart data received');
          }
          
          updateCartSummary(cart);
          updateCartItems(cart);
          return cart;
        } catch (error) {
          console.error('Error refreshing cart:', error);
          location.reload();
          throw error;
        }
      };

      const updateCart = async () => {
        const formData = new FormData(cartForm);
        
        try {
          const response = await fetch('/cart/update.js', {
            method: 'POST',
            body: formData
          });

          if (response.ok) {
            // Use the cart data from the update response instead of making another request
            const cart = await response.json();
            if (cart && typeof cart === 'object') {
              updateCartSummary(cart);
              updateCartItems(cart);
              
              // Update cart count
              const cartCountElements = document.querySelectorAll('[data-cart-count]');
              for (const element of cartCountElements) {
                element.textContent = cart.item_count || 0;
              }
              
              // Dispatch event
              document.dispatchEvent(new CustomEvent('cart:updated', {
                detail: { cart }
              }));
            } else {
              // Fallback to refresh if response format is unexpected
              await refreshCart();
            }
          } else {
            const errorData = await response.json().catch(() => ({}));
            throw new Error(errorData.description || 'Failed to update cart');
          }
        } catch (error) {
          console.error('Error updating cart:', error);
          throw error;
        }
      };

      const quantityButtons = cartForm.querySelectorAll('[data-increase-quantity], [data-decrease-quantity]');
      
      for (const button of quantityButtons) {
        button.addEventListener('click', async (e) => {
          e.preventDefault();
          const key = button.getAttribute('data-key');
          const input = cartForm.querySelector(`input[data-key="${key}"]`);
          if (!input) return;

          const currentValue = parseInt(input.value, 10) || 0;
          const isIncrease = button.hasAttribute('data-increase-quantity');
          let newValue = isIncrease ? currentValue + 1 : Math.max(0, currentValue - 1);
          
          if (isNaN(newValue) || newValue < 0) {
            newValue = 0;
          }

          if (newValue === currentValue) return;

          input.value = newValue;
          button.disabled = true;

          try {
            await updateCart();
          } catch (error) {
            input.value = currentValue;
            alert('Failed to update cart. Please try again.');
          } finally {
            button.disabled = false;
          }
        });
      }

      const quantityInputs = cartForm.querySelectorAll('.cart-product__quantity-input');
      
      for (const input of quantityInputs) {
        let originalValue = parseInt(input.value, 10) || 0;
        
        input.addEventListener('change', async () => {
          let newValue = parseInt(input.value, 10);
          
          if (isNaN(newValue) || newValue < 0) {
            newValue = 0;
            input.value = 0;
          }

          if (newValue === originalValue) return;

          const previousValue = originalValue;
          originalValue = newValue;

          input.disabled = true;

          try {
            await updateCart();
          } catch (error) {
            input.value = previousValue;
            originalValue = previousValue;
            alert('Failed to update cart. Please try again.');
          } finally {
            input.disabled = false;
          }
        });

        input.addEventListener('keydown', (e) => {
          if (e.key === 'Enter') {
            e.preventDefault();
            input.blur();
          }
        });
      }

      const removeButtons = cartForm.querySelectorAll('[data-remove-item]');
      
      for (const button of removeButtons) {
        button.addEventListener('click', async (e) => {
          e.preventDefault();
          const key = button.getAttribute('data-key');
          const input = cartForm.querySelector(`input[data-key="${key}"]`);
          const itemRow = cartForm.querySelector(`[data-line-item="${key}"]`);

          if (!input) return;

          const previousValue = parseInt(input.value, 10) || 0;
          input.value = 0;

          if (itemRow) {
            itemRow.style.opacity = '0.5';
            itemRow.style.transition = 'opacity 0.3s';
          }

          button.disabled = true;

          try {
            await updateCart();
            const cart = await refreshCart();
            
            if (!cart || !cart.items || cart.items.length === 0) {
              location.reload();
            }
          } catch (error) {
            console.error('Error removing item:', error);
            input.value = previousValue;
            if (itemRow) {
              itemRow.style.opacity = '1';
            }
            alert('Failed to remove item. Please try again.');
          } finally {
            button.disabled = false;
          }
        });
      }

      cartForm.addEventListener('submit', (e) => {
        const submitButton = e.submitter;
        if (!submitButton || submitButton.name !== 'checkout') {
          e.preventDefault();
        }
      });
    };
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initCart);
    } else {
      initCart();
    }
  })();
</script>

{% stylesheet %}
.cart-page {
  width: 100%;
  padding: 60px 0;
  min-height: 60vh;
  background-color: rgba(0, 0, 0, 0);
}

.cart-page__container {
  max-width: var(--container-max);
  margin: 0 auto;
  padding: 0 var(--container-padding);
}

.cart-page__title {
  font-family: var(--font-heading);
  font-weight: 700;
  font-size: 48px;
  line-height: 1;
  color: var(--color-black);
  margin: 0 0 24px 0;
  text-align: left;
}

.cart-page__progress {
  margin-bottom: 40px;
}

.cart-page__progress-bar {
  display: flex;
  align-items: center;
  height: 40px;
}

.cart-page__progress-bar::after {
  content: '';
  flex: 1;
  height: 2px;
  background-color: var(--color-dark-blue);
  margin-left: 0;
}

.cart-page__progress-text {
  display: inline-flex;
  align-items: center;
  height: 100%;
  padding: 0 20px;
  background-color: var(--color-dark-blue);
  border-radius: 6px 0 0 6px;
  font-family: 'Overpass', sans-serif;
  font-weight: 400;
  font-size: 16px;
  line-height: 1;
  color: var(--color-white);
  text-transform: uppercase;
  white-space: nowrap;
}

.cart-page__content {
  display: grid;
  grid-template-columns: 1fr 400px;
  gap: 40px;
  align-items: start;
}

.cart-page__products {
  display: flex;
  flex-direction: column;
}

.cart-products__header {
  display: grid;
  grid-template-columns: 2fr 1fr 1fr 1fr;
  gap: 20px;
  padding: 16px 20px;
  background-color: var(--color-light-blue);
  border-radius: 6px;
  margin-bottom: 20px;
  box-shadow: 4px 4px 0px 0px rgba(0, 0, 0, 1);
}

.cart-products__header-cell {
  font-family: var(--font-heading);
  font-weight: 700;
  font-size: 14px;
  line-height: 1;
  color: var(--color-dark-blue);
  text-transform: uppercase;
}

.cart-products__header-cell--product {
  text-align: left;
}

.cart-products__header-cell--price {
  text-align: center;
}

.cart-products__header-cell--qty {
  text-align: center;
}

.cart-products__header-cell--total {
  text-align: right;
}

.cart-products__items {
  display: flex;
  flex-direction: column;
  gap: 0;
}

.cart-product {
  position: relative;
  display: grid;
  grid-template-columns: 2fr 1fr 1fr 1fr;
  gap: 17px;
  align-items: center;
  padding: 13px 20px;
  margin-top: 16px;
  margin-bottom: 16px;
  background-color: var(--color-white);
  border-radius: 6px;
  border: 1px solid rgba(0, 0, 0, 1);
  box-shadow: 4px 4px 0px 0px rgba(0, 0, 0, 0.5);
}

.cart-product__details {
  display: flex;
  align-items: center;
  gap: 16px;
}

.cart-product__image {
  width: 120px;
  height: 120px;
  flex-shrink: 0;
  overflow: hidden;
  border-radius: 6px;
  background-color: #F5F5DC;
  border: 1px solid var(--color-black);
}

.cart-product__image img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 6px;
}

.cart-product__placeholder {
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: var(--color-gray);
}

.cart-product__placeholder svg {
  width: 60%;
  height: 60%;
  opacity: 0.5;
}

.cart-product__info {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.cart-product__name {
  font-family: var(--font-heading);
  font-weight: 400;
  font-size: 18px;
  line-height: 1.2;
  color: var(--color-black);
  margin: 0;
}

.cart-product__name a {
  color: inherit;
  text-decoration: none;
}

.cart-product__description {
  font-family: var(--font-body);
  font-size: 14px;
  line-height: 1.2;
  color: var(--color-text-secondary);
  margin: 0;
}

.cart-product__price {
  font-family: 'Overpass', sans-serif;
  font-weight: 400;
  font-size: 18px;
  line-height: 1;
  color: var(--color-black);
  text-align: center;
}

.cart-product__quantity {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.cart-product__quantity-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  background-color: var(--color-white);
  border: 1px solid var(--color-black);
  border-radius: 6px;
  color: var(--color-black);
  cursor: pointer;
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
  font-family: var(--font-heading);
  font-weight: 400;
  font-size: 18px;
  line-height: 1;
}

.cart-product__quantity-btn:hover {
  transform: translate(-1px, -1px);
  box-shadow: 2px 2px 0px 0px var(--color-black);
}

.cart-product__quantity-btn:active {
  transform: translate(1px, 1px);
  box-shadow: 1px 1px 0px 0px var(--color-black);
}

.cart-product__quantity-input {
  width: 50px;
  height: 32px;
  padding: 0 8px;
  font-family: var(--font-heading);
  font-weight: 400;
  font-size: 16px;
  text-align: center;
  background-color: var(--color-white);
  border: 1px solid var(--color-black);
  border-radius: 6px;
}

.cart-product__total {
  font-family: 'Overpass', sans-serif;
  font-weight: 400;
  font-size: 18px;
  line-height: 1;
  color: var(--color-black);
  text-align: right;
}

.cart-product__remove {
  position: absolute;
  top: 10px;
  right: 10px;
  width: 24px;
  height: 24px;
  padding: 0;
  background-color: transparent;
  border: none;
  color: var(--color-text-secondary);
  cursor: pointer;
  opacity: 0;
  transition: opacity var(--transition-fast);
}

.cart-product:hover .cart-product__remove {
  opacity: 1;
}

.cart-page__summary {
  position: sticky;
  top: 100px;
}

.cart-summary {
  padding: 24px;
  background-color: var(--color-light-blue);
  border-radius: 6px;
  box-shadow: 4px 4px 0px 0px rgba(0, 0, 0, 1);
}

.cart-summary__title {
  font-family: var(--font-heading);
  font-weight: 700;
  font-size: 30px;
  line-height: 1;
  color: var(--color-dark-blue);
  text-transform: uppercase;
  text-align: center;
  margin: 0 0 20px 0;
}

.cart-summary__row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 0;
}

.cart-summary__row--discount {
  color: var(--color-green);
}

.cart-summary__label {
  font-family: 'Overpass', sans-serif;
  font-weight: 600;
  font-size: 24px;
  line-height: 1;
  color: var(--color-dark-blue);
  text-transform: uppercase;
}

.cart-summary__value {
  font-family: 'Overpass', sans-serif;
  font-weight: 400;
  font-size: 20px;
  line-height: 1;
  color: var(--color-dark-blue);
}

.cart-summary__row--total {
  margin-top: 8px;
  padding-top: 16px;
}

.cart-summary__row--total .cart-summary__label {
  font-size: 14px;
}

.cart-summary__value--total {
  font-size: 32px;
  font-weight: 700;
}

.cart-summary__divider {
  height: 1px;
  border-top: 1px dashed var(--color-dark-blue);
  margin: 16px 0;
}

.cart-summary__promo {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 16px;
}

.cart-summary__promo-label {
  font-family: var(--font-heading);
  font-weight: 400;
  font-size: 12px;
  line-height: 1;
  color: var(--color-dark-blue);
  text-transform: uppercase;
}

.cart-summary__promo-input {
  width: 100%;
  height: 40px;
  padding: 0 12px;
  font-family: var(--font-body);
  font-size: 14px;
  color: var(--color-black);
  background-color: var(--color-white);
  border: 1px solid var(--color-black);
  border-radius: 6px;
}

.cart-summary__promo-input::placeholder {
  color: var(--color-text-secondary);
}

.cart-summary__actions {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-top: 24px;
}

.cart-summary__btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 48px;
  padding: 0 24px;
  font-family: var(--font-heading);
  font-weight: 400;
  font-size: 16px;
  line-height: 1;
  text-decoration: none;
  border-radius: 6px;
  border: 2px solid var(--color-black);
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
  cursor: pointer;
}

.cart-summary__btn--primary {
  background-color: var(--color-green);
  color: var(--color-black);
  box-shadow: 4px 4px 0px 0px var(--color-black);
}

.cart-summary__btn--primary:hover {
  transform: translate(-2px, -2px);
  box-shadow: 6px 6px 0px 0px var(--color-black);
}

.cart-summary__btn--primary:active {
  transform: translate(2px, 2px);
  box-shadow: 2px 2px 0px 0px var(--color-black);
}

.cart-summary__btn--secondary {
  background-color: var(--color-white);
  color: var(--color-dark-blue);
  box-shadow: 4px 4px 0px 0px var(--color-dark-blue);
}

.cart-summary__btn--secondary:hover {
  transform: translate(-2px, -2px);
  box-shadow: 6px 6px 0px 0px var(--color-dark-blue);
}

.cart-summary__btn--secondary:active {
  transform: translate(2px, 2px);
  box-shadow: 2px 2px 0px 0px var(--color-dark-blue);
}

.cart-summary__additional-checkout {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--color-gray);
}

.cart-page__empty {
  display: flex;
  align-items: center;
  justify-content: center;
  min-height: 400px;
}

.cart-empty {
  text-align: center;
  max-width: 500px;
}

.cart-empty__title {
  font-family: var(--font-heading);
  font-weight: 600;
  font-size: 32px;
  color: var(--color-black);
  margin: 0 0 16px 0;
}

.cart-empty__text {
  font-family: var(--font-body);
  font-size: 16px;
  color: var(--color-text-secondary);
  margin: 0 0 24px 0;
}

@media screen and (max-width: 992px) {
  .cart-page__content {
    grid-template-columns: 1fr;
    gap: 32px;
  }

  .cart-page__summary {
    position: static;
  }

  .cart-products__header {
    display: none;
  }

  .cart-product {
    grid-template-columns: 1fr;
    gap: 17px;
    padding: 13px 16px;
    margin-top: 16px;
    margin-bottom: 16px;
  }

  .cart-product__details {
    gap: 12px;
  }

  .cart-product__image {
    width: 100px;
    height: 100px;
  }

  .cart-product__price {
    display: flex;
    align-items: center;
    justify-content: space-between;
    text-align: left;
  }

  .cart-product__price::before {
    content: 'PRICE:';
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: 12px;
    text-transform: uppercase;
    color: var(--color-dark-blue);
    margin-right: 12px;
  }

  .cart-product__quantity {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .cart-product__quantity::before {
    content: 'QTY:';
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: 12px;
    text-transform: uppercase;
    color: var(--color-dark-blue);
  }

  .cart-product__total {
    display: flex;
    align-items: center;
    justify-content: space-between;
    text-align: left;
  }

  .cart-product__total::before {
    content: 'TOTAL:';
    font-family: var(--font-heading);
    font-weight: 700;
    font-size: 12px;
    text-transform: uppercase;
    color: var(--color-dark-blue);
    margin-right: 12px;
  }

  .cart-product__remove {
    opacity: 1;
    top: 12px;
    right: 12px;
    width: 32px;
    height: 32px;
  }
}

@media screen and (max-width: 768px) {
  .cart-page {
    padding: 32px 0;
  }

  .cart-page__container {
    padding: 0 16px;
  }

  .cart-page__title {
    font-size: 36px;
    margin-bottom: 20px;
  }

  .cart-page__progress {
    margin-bottom: 24px;
  }

  .cart-page__progress-text {
    font-size: 14px;
    padding: 0 16px;
  }

  .cart-page__content {
    gap: 24px;
  }

  .cart-product {
    padding: 16px;
    gap: 12px;
  }

  .cart-product__details {
    gap: 12px;
  }

  .cart-product__image {
    width: 80px;
    height: 80px;
  }

  .cart-product__name {
    font-size: 16px;
  }

  .cart-product__description {
    font-size: 13px;
  }

  .cart-product__price,
  .cart-product__total {
    font-size: 16px;
  }

  .cart-product__quantity-btn {
    width: 36px;
    height: 36px;
    font-size: 20px;
  }

  .cart-product__quantity-input {
    width: 60px;
    height: 36px;
    font-size: 16px;
  }

  .cart-summary {
    padding: 20px;
  }

  .cart-summary__title {
    font-size: 24px;
    margin-bottom: 16px;
  }

  .cart-summary__label {
    font-size: 18px;
  }

  .cart-summary__value {
    font-size: 18px;
  }

  .cart-summary__value--total {
    font-size: 28px;
  }

  .cart-summary__btn {
    height: 44px;
    font-size: 15px;
  }
}

@media screen and (max-width: 576px) {
  .cart-page {
    padding: 24px 0;
  }

  .cart-page__title {
    font-size: 28px;
    margin-bottom: 16px;
  }

  .cart-page__progress-text {
    font-size: 12px;
    padding: 0 12px;
  }

  .cart-product {
    padding: 12px;
    gap: 10px;
  }

  .cart-product__image {
    width: 70px;
    height: 70px;
  }

  .cart-product__name {
    font-size: 15px;
  }

  .cart-product__description {
    font-size: 12px;
  }

  .cart-product__price,
  .cart-product__total {
    font-size: 15px;
  }

  .cart-product__price::before,
  .cart-product__total::before {
    font-size: 11px;
    margin-right: 8px;
  }

  .cart-product__quantity::before {
    font-size: 11px;
  }

  .cart-product__quantity-btn {
    width: 32px;
    height: 32px;
    font-size: 18px;
  }

  .cart-product__quantity-input {
    width: 50px;
    height: 32px;
    font-size: 15px;
  }

  .cart-product__remove {
    width: 28px;
    height: 28px;
    top: 8px;
    right: 8px;
  }

  .cart-summary {
    padding: 16px;
  }

  .cart-summary__title {
    font-size: 20px;
    margin-bottom: 12px;
  }

  .cart-summary__row {
    padding: 10px 0;
  }

  .cart-summary__label {
    font-size: 16px;
  }

  .cart-summary__value {
    font-size: 16px;
  }

  .cart-summary__value--total {
    font-size: 24px;
  }

  .cart-summary__promo {
    margin-bottom: 12px;
  }

  .cart-summary__promo-label {
    font-size: 11px;
  }

  .cart-summary__promo-input {
    height: 36px;
    font-size: 13px;
  }

  .cart-summary__actions {
    gap: 10px;
    margin-top: 16px;
  }

  .cart-summary__btn {
    height: 40px;
    font-size: 14px;
  }

  .cart-empty__title {
    font-size: 24px;
  }

  .cart-empty__text {
    font-size: 14px;
  }
}
{% endstylesheet %}

{% schema %}
{
  "name": "Cart",
  "tag": "section",
  "class": "cart-section",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "Cart Title",
      "default": "YOUR CART"
    },
    {
      "type": "text",
      "id": "empty_title",
      "label": "Empty Cart Title",
      "default": "Your cart is empty"
    },
    {
      "type": "textarea",
      "id": "empty_text",
      "label": "Empty Cart Text",
      "default": "Continue shopping to add items to your cart."
    },
    {
      "type": "text",
      "id": "continue_shopping_text",
      "label": "Continue Shopping Button Text",
      "default": "continue shopping"
    },
    {
      "type": "url",
      "id": "continue_shopping_url",
      "label": "Continue Shopping Link",
      "info": "Select a page, collection, or enter a custom URL for the Continue Shopping button. If left empty, it will link to all products."
    },
    {
      "type": "text",
      "id": "buy_now_text",
      "label": "Buy Now Button Text",
      "default": "Buy Now"
    },
    {
      "type": "text",
      "id": "promo_code_label",
      "label": "Promo Code Label",
      "default": "PROMO CODE"
    },
    {
      "type": "text",
      "id": "promo_code_placeholder",
      "label": "Promo Code Placeholder",
      "default": "ENTER HERE"
    }
  ],
  "presets": [
    {
      "name": "Cart"
    }
  ]
}
{% endschema %}
